**侧信道攻击**（Side Channel Attack：SCA）技术利用了密码芯片泄漏的侧信道信息，例如时间、功耗、电磁等物理信息，这些信息均是密码芯片运算过程中产生的，同时它不需要对芯片进行开盖等物理性破坏，攻击方法具有隐蔽性，不容易被检测。侧信道攻击技术通过一定的统计手段把这些泄漏的物理信息进行处理，再与传统的密码数学分析方法相结合来获取密码芯片的密钥信息。

![](vx_images/225430711237135.png =600x)


上图概括了侧信道攻击实施的基本原理，攻击者**输入大量的明文**，同时捕获并记录密码芯片运行过程中所**泄漏的侧信道信号**，当攻击者采集到大量的样本后，将**侧信道信息**与**猜测密钥侧信道攻击模型**做**相关性校验**，相关性最大的猜测密钥即为正确的密钥。

根据攻击者所利用的物理信息不同，侧信道攻击可以分为**功耗分析攻击**、**电磁辐射攻击**、**时间攻击**、**错误注入攻击**。

# 1**功耗分析攻击**

功耗分析攻击是最为充分、成功实例最多的一种侧信道攻击技术。功耗分析攻击本质上是利用密码芯片在运算时所消耗的**功耗**来破译出密钥的一种攻击方法。由于密码芯片在处理不同运算以及不同的操作数时消耗的功耗不同，所以可以通过分析密码芯片的功耗特征来判断运算所涉及的操作数，从而恢复出密钥信息。功耗分析攻击是针对密码算法的硬件实现，通过测量加密系统的功耗来恢复密钥的一种攻击方法。

密码芯片的能量消耗与所处理的数据和所执行的操作具有一定的相关性，当前的集成电路基本上是采用CMOS工艺制造的是其主要原因，CMOS电路的功耗与其输入和输出数据有着密切的关系。

当CMOS电路的输出端发生从逻辑0到逻辑1跳变时，会产生充电电流；当CMOS电路的输出端发生逻辑1到逻辑0跳变时，会产生放电电流；当CMOS电路的输出端维持逻辑0或者逻辑1不变时，电路没有**动态电流**产生，因此没有**动态功耗**产生。

根据功耗分析攻击的分析方法不同可以分为**简单功耗分析**（Simple Power Analysis：SPA）攻击、**差分功耗分析**（Differential Power Analysis：DPA）攻击、**相关功耗分析**（Correlation Power Analysis：CPA）攻击、**高阶差分功耗分析**（High Order DPA：HODPA）攻击等不同分析类型。

## **简单功耗分析**SPA

简单功耗分析攻击是通过直接观察密码芯片的功耗轨迹来推断芯片密钥的一种攻击方法，这种方法对攻击者的要求较高，且受噪声影响较大。在对称加密算法的功耗攻击中SPA攻击强度较低，SPA更适合与RSA等公钥加密算法的模乘、模平方的功耗分析。

## **差分功耗分析**DPA

DPA攻击需要采样大量的功耗信息，即能量迹。利用统计学分析方法，找到这些能量迹与密钥的相关性，从而恢复出密钥。另一方面，SPA攻击主要**沿时间轴**来分析设备的能量消耗，攻击者试图在**一条能量迹**中找到某种操作。而DPA攻击中，沿时间轴的能量迹的形状并非如此重要，DPA关注的是所有能量迹在**同一时刻的统计特性**。

差分功耗分析攻击是将采集到的能量迹按照一定的规则划分成不同的两个集合，然后对这两个集合求平均值，最后对两个均值进行差值处理。(主要依赖于汉明重量模型)

目前应用比较广泛的 DPA 攻击主要有两种：**单指数多数据**（SEMD: Single-Exponent, Multiple-Data）、**多指数单数据**（MESD: Multiple-Exponent, Single-Data）攻击方法。

### SEMD攻击

SEMD 攻击有一个前提条件，那就是假设密码芯片系统允许攻击者能够用两个幂指数（一个是秘密指数和一个公开指数）对**任意多的随机数据**进行**模幂**运算。SEMD 攻击的核心思想是：通过比较秘密指数运算产生的功耗和公开指数运算产生的功耗之间的差异从而获取密钥。

### MESD攻击

MESD 攻击的前提条件是密码芯片系统允许攻击者使用**多次幂指数**对一个**常量**进行**模幂**运算。与 SEMD 攻击相比，MESD 攻击性更强，因为 SEMD 攻击产生的DPA 偏差信号有时候不容易区分，而使用 MESD 攻击能够提高信噪比。

MESD攻击的核心思想是是先用**秘密指数**对—个**数据**进行**模幂**运算，并记录其功耗波形。然后用**猜测的指数**对**同**一个**数据**进行相同的运算，并也记录其功耗波形，然后将二者的功耗波形相减，通过分析差分后的功耗曲线来验证猜测密钥中某一位的值是1还是0，接着再用验证正确的猜测指数重新进行上述操作，逐位更新猜测指数的相应位，最终获得完整的秘密指数。

## **相关功耗分析**CPA

相关功耗分析攻击采用相关系数的统计学方法。该方法首先利用**功耗模型**对进行攻击的实际电路进行**理论功耗的预测**，然后将**实际的电路功耗**与**预测的理论功**耗联系起来，得出两者之间的**相关系数**。因为如果猜测的密钥正确，那么根据电路功耗模型计算的理论功耗一定与实际电路的功耗具有一定的相关性。根据**相关性的大小**也就是**相关系数**的大小来判定密钥的猜测是否正确。

# 2**电磁辐射攻击**

电磁辐射攻击是通过测量芯片运算过程中的电磁辐射来实现功耗分析攻击的目的。

电磁辐射攻击的原理是：当设备内部状态的某比特由0变为1，或相反的由1变为0时，晶体管的N极或P极会有一小段时间是接通的，这将导致一个瞬时的**电流脉冲**，从而导致周围的**电磁场发生变化**。通过放置在附件的探头即可测量出设备运行时的电磁辐射情况，经过采样、数字化及信号放大后，即可使用类似于功耗分析攻击的统计方法来恢复出密钥。

功耗分析攻击只能对**整个芯片**的功耗进行分析，这些功耗中会包含密码算法执行模型的功耗，同时也包含其他模块的功耗；电磁辐射攻击可以将探头靠近芯片上方执行**密码算法的模块**，这样可以降低芯片上的其他模块引入的噪声影响，因此**电磁辐射攻击**有**更高的信噪比**。电磁辐射攻击与功耗分析攻击所采用的分析方法、攻击步骤完全一样，因此可以看作是功耗分析攻击的一种变种攻击方法。**因此对于功耗分析攻击的攻击技术和防护技术也同样适用于电磁辐射攻击。**

# **3时间攻击**

时间攻击的基本原理很简单，就是利用加密算法所采用的各种运算执行时间上的差异来恢复密钥信息。这是因为密码算法在执行**运行时间不固定**的操作时，如分支操作、有限域乘法、幂指数运算等，其具体的运行时间是由所涉及的**操作数决定**的。由于每步的操作均**依赖**于所使用的**密钥**，所以算法的运行时间在一定程度上依赖于所使用的密钥。据此，根据算法运行时间上的差异与所使用的密钥间的关系，利用统计方法分析时间差异即可恢复部分或全部密钥信息。

# 4**错误注入攻击**

密码芯片能在执行不同密码运算的过程中保证正确率，但在外界出现干扰的情况下，密码模块在运算过程中可能出现**硬件故障**或**运算错误**，通过此类故障行为或错误信息来恢复密钥的攻击即是错误注入攻击。

在侧信道攻击的四种方法中，**功耗分析攻击**以其攻击设备成本低、易于操作和实现，越来越受到研究者的关注。与**时间攻击**相比，由于其采用了**统计学**的方法，更加容易恢复出运算过程中的密钥。而且在密码芯片的**对称密码算法**硬件实现中，**加解密时间与密钥无关，即不存在时间攻击的可能**，但是对于功耗分析攻击仍然有效。因此功耗分析攻击比时间攻击具有更大的危害性。**错误注入攻击**中错误的引入需要采用激光等设备，实施的成本相对较高，且注入攻击者期望的错误需要花费大量的时间，**实施难度越大**。而电磁辐射攻击本身就与功耗分析攻击关系紧密。因此，从某种意义上说，目前对密码芯片构成最严重威胁的侧信道攻击技术是功耗分析攻击。

# 5典型的功耗分析模型

在动态功耗分析攻击和静态功耗分析攻击中，通常需要将与**密钥相关的中间变量**映射成**理论功耗**或者进行**功耗仿真**，这就需要一种**能量模型**，**可以根据中间数据近似地估算出当前时刻的动态功耗或静态功耗**。值得注意的是，根据功耗模型计算出来的功耗，其绝对值是毫无意义的，功耗分析攻击利用的是数据的相关性。因此，**功耗的绝对值毫无意义，有意义的是功耗的相对值**。

## 汉明距离模型

[**汉明距离**](https://baike.baidu.com/item/%E6%B1%89%E6%98%8E%E8%B7%9D%E7%A6%BB)是使用在数据传输差错控制编码里面的，汉明距离是一个概念，它表示两个（相同长度）字符串对应位置的不同字符的数量。

汉明距离模型是较为常见的一种功耗模型，非常适用于动态功耗分析攻击，特别是用来攻击时序电路中的**寄存器**或者是**微控制器的总线**时，经常选择汉明距离模型。汉明距离模型的基本思想是计算数字电路在某个**特定的时间段内**，0到1转换和1到0转换的总数，然后利用转换的总数来刻画电路在这一时间段内的动态能量消耗的平均值。

## 汉明重量模型

[**汉明重量**](https://baike.baidu.com/item/%E6%B1%89%E6%98%8E%E9%87%8D%E9%87%8F)是一串符号中非零符号的个数。因此它等同于同样长度的全零符号串的汉明距离。

汉明重量模型用于评估**动态能量消耗**时，攻击者假设**动态能量消耗**与被处理的数据中**被置位的比特个数**成**正比**，忽略了在该数据之前所处理的数值。所以用汉明重量模型来刻画电路的动态功耗，仅仅是一种近似的表达方法。在实际的动态功耗分析攻击中，当没有办法采用汉明距离模型时，攻击者一般会采用汉明重量模型。 汉明重量模型用于评估**静态能量消耗**时，攻击者假设此时电路的**静态漏电流**与电路此时的**数据比特1的个数**成正比。因为静态功耗不需要考虑电路之前的状态，仅需要考虑电路当前的状态，因此汉明重量模型非常适合于静态功耗分析攻击。