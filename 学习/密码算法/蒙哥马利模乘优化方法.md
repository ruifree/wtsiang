# 蒙哥马利模乘优化方法


## 参考文献
1. 统一架构的ECC与RSA密码处理器的设计.刘兵


## 蒙哥马利模乘
目前，蒙哥马利模乘已经发展出了很多的改进和优化版本。这些算法都是在原始蒙哥马利模乘的基础上，使用不同的改进策略进行优化而得到的，这些算法按照一些规则可以进行如下的分类。 
**分类规则**：对蒙哥马利模乘输入的两个乘数操作数按操作方式的不同可分为几类： 
1) 操作数**整体**进行运算，称为full precision，简写为FP。  
2) 操作数**逐位**进行运算，称为radix 2，简写为R2。 
3) 将操作数划分为多个字，**逐个字**进行运算，字的大小一般为8的倍数，该方法称为word level，简写为WL，有时也称为high radix。 

因此，按照上述规则，对模乘的两个操作数按照不同划分方式，可以将目前的算法大致分为以下几种： 
1) **FP类算法**：模乘的两个乘数均为fp，即不对操作数切分，整体直接参与运算，原始蒙哥马利模乘算法属于此类。 
2) **R2类算法**：其中一个乘数按radix 2切分后参加运算，即逐位计算。同时，另一个操作数一般使用按字分割（wl），即逐字计算，该算法被称 之为Multiple-Word Radix 2 Montgomery Multiplication，简写为 MWR2MM。 
3) **Rk类算法或称为R2k类算法**：其中一个乘数按radix 2 k切分后参加运算， 即逐k位计算（k一般小于等于4）。另一个操作数切分按wl，即逐字 计算，该算法也被称之为Multiple-Word Radix k Montgomery  Multiplication，可简写为MWRkMM。该算法可看成是对R2算法的升级。 
4) **WL类算法**：两个操作数均逐字扫描并参与运算。进一步地，按照对蒙哥马利模乘中乘法和约减操作的处理的不同：一种处理方法是将**乘法**和**约减**分开计算（Separated），另一种是将两者结合（Integrated），可以更细致的将WL类算法划分出子类：  
a) **CIOS** ( Coarsely Integrated Operand Scanning )：粗粒度地整合乘法和约减操作。乘法和约减分布在两个内循环之内。  
b) **FIOS** ( Finely Integrated Operand Scanning )：细粒度地整合乘法和约减操作。乘法和约减分布在同一个内循环之内。  
c) **SOS** ( Separated Operand Scanning ): 分离的乘法和约减操作。  下面的小节将分别对其中几种主要的算法进行说明。 SOS算法同原始蒙哥马利模乘算法一样，先计算乘法，然后对乘法的结果来进行约减操作，这样存储乘法结果所需要的临时存储空间会很大，不利于硬件实现。 

## FIOS 
![](vx_images/172373719246331.png =601x)

![](vx_images/468363719242085.png =600x)


## CIOS
![](vx_images/446975313249083.png =608x)

![](vx_images/530053819257569.png =680x)
